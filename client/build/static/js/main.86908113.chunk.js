(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{24:function(e,t,n){e.exports={container:"photopage_container__GUJqG",invisible:"photopage_invisible__3k6NC",floating:"photopage_floating__3-nOm",active:"photopage_active__3lihy",regular:"photopage_regular__2qyBY"}},38:function(e,t,n){e.exports={container:"newphotopage_container__3u8Ys",invisible:"newphotopage_invisible__V0F9x",floating:"newphotopage_floating__HliyZ"}},39:function(e,t,n){e.exports={invisible:"galleries_invisible__6bZJt",visible:"galleries_visible__2LFml",gallery:"galleries_gallery__3WSy6",thumbnail:"galleries_thumbnail__wmdhg",topalign:"galleries_topalign__NkLNc"}},40:function(e,t,n){e.exports={hidden:"addcomment_hidden__1gKDJ",addcomment:"addcomment_addcomment__DweRn"}},44:function(e,t,n){e.exports={small:"photo_small__2tgGO"}},57:function(e,t,n){},58:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),i=n.n(a),o=n(30),r=n.n(o),l=(n(57),n(58),n(6)),s=n(7),u=function(){var e=Object(s.b)(),t=e.loginWithRedirect,n=e.logout;return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Welcome to Photo Commentor"}),Object(c.jsx)("button",{type:"button",onClick:function(){return t()},children:"Login or Register"}),Object(c.jsx)("button",{type:"button",onClick:function(){return n()},children:"Logout"})]})})},d=(n(71),n(5)),j=n(3),h=n(9),b=n.n(h),g=n(23),m=n.n(g),p=n(31),O=function(){var e=Object(p.a)(m.a.mark((function e(t,n,c){var a,i,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({});case 3:return i=e.sent,a=c?{method:"POST",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify(c)}:{method:"GET",headers:{Authorization:"Bearer ".concat(i)}},e.next=7,fetch("http://localhost:8002/api/"+n,a);case 7:return o=e.sent,e.abrupt("return",o.json());case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,c){return e.apply(this,arguments)}}(),x=n(44),f=n.n(x),_=function(e){var t=e.photo,n=t.path,a=t._id,i=t.ratings,o=t.comments,r=Object(l.c)();return Object(c.jsxs)("div",{className:f.a.small,onClick:function(){return r("/photos/"+a)},children:[Object(c.jsx)("img",{src:n,alt:"Comment-tagged"}),Object(c.jsx)("h5",{children:"Ratings"}),i&&i.map((function(e){return Object(c.jsxs)("p",{children:[e.user_id," - ",e.rating]})})),Object(c.jsx)("h5",{children:"Comments"}),o&&o.map((function(e){return Object(c.jsx)("p",{children:"".concat(e.user_id," (").concat(e.x,", ").concat(e.y,") - ").concat(e.comment)})}))]})},v=function(e){var t=Object(s.b)(),n=t.user,i=t.isLoading,o=t.getAccessTokenSilently,r=Object(a.useState)({}),u=Object(d.a)(r,2),h=u[0],g=u[1],m=Object(l.c)();Object(a.useEffect)((function(){i||g({gallery_name:"New gallery . . . ",authorized_user_ids:"List authorized users . . . "})}),[i]);return Object(c.jsxs)("div",{className:b.a.container,children:[Object(c.jsx)("button",{onClick:function(){return m("/loggedin/")},children:"Back to gallery list!"}),Object(c.jsx)("h2",{children:"Please enter information for your new gallery."}),Object(c.jsxs)("form",{className:b.a.floating,children:[Object(c.jsx)("input",{type:"text",name:"name",value:h.gallery_name,onChange:function(e){return g(Object(j.a)(Object(j.a)({},h),{},{gallery_name:e.target.value}))}}),Object(c.jsx)("label",{children:" Authorized Users (separate by commas): "}),Object(c.jsx)("input",{type:"text",name:"name",value:h.authorized_user_ids,onChange:function(e){return g(Object(j.a)(Object(j.a)({},h),{},{authorized_user_ids:e.target.value.toString().split(",")}))}}),Object(c.jsx)("button",{type:"button",name:"save",onClick:function(){var e={gallery_name:h.gallery_name,authorized_user_ids:h.authorized_user_ids,owner_id:n.sub};console.log(e),O(o,"gallery/new",e).then((function(e){m("/gallery/"+e._id)})).catch((function(e){return console.log(e)}))},children:"Save"})]})]})},y=n(38),C=n.n(y),k=function(e){var t=Object(s.b)(),n=t.isLoading,i=t.getAccessTokenSilently,o=e.togallery,r=Object(a.useState)({}),u=Object(d.a)(r,2),h=u[0],b=u[1],g=Object(l.c)();Object(a.useEffect)((function(){n||b({gallery_id:o}),console.log("Ran use effect")}),[n]);return Object(c.jsxs)("div",{className:C.a.container,children:[Object(c.jsx)("img",{src:h.path,alt:"User submitted with comments"}),Object(c.jsx)("button",{onClick:function(){O(i,"photos/add/"+o,h).then((function(e){console.log(e),g("/photos/"+e.photo[e.photo.length-1]._id)})).catch((function(e){return console.log(e)}))},children:"Save"}),Object(c.jsx)("form",{className:C.a.floating,children:Object(c.jsx)("input",{type:"text",name:"path",value:h.path,onChange:function(e){return b(Object(j.a)(Object(j.a)({},h),{},{path:e.target.value}))}})})]})},w=n(39),N=n.n(w),S=function(e){var t=Object(s.b)(),n=t.user,i=(t.isAuthenticated,t.isLoading),o=t.getAccessTokenSilently,r=Object(a.useState)([]),u=Object(d.a)(r,2),j=u[0],h=u[1],b=Object(l.c)(),g=e.setNavPath;Object(a.useEffect)((function(){if(!i){console.log("Retrieving galleries!");var e=j;O(o,"photos/owner/"+n.sub).then((function(t){h(e=t),console.log("Galleries:",e)})).catch((function(e){return console.log(e)})),g([{name:n.name+" Galleries",link:"/loggedin/"}])}}),[i]);return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{onClick:function(){if(!i){console.log("Retrieving galleries!");var e=j;O(o,"photos/owner/"+n.sub).then((function(t){h(e=t),console.log("Galleries:",e)})).catch((function(e){return console.log(e)}))}},children:"Run retrieve again!"}),Object(c.jsx)("button",{name:"addnewgallery",onClick:function(){return b("/gallery/new")},children:"Add new gallery!"})]}),j&&j.map((function(e){return Object(c.jsxs)("div",{className:N.a.gallery,onClick:function(){return b("/gallery/"+e._id)},children:[Object(c.jsx)("h2",{children:e.gallery_name}),Object(c.jsxs)("p",{children:["Photo Count: ",e.photo.length]}),e.photo.length&&e.photo.map((function(e,t){if(!(t>4))return Object(c.jsx)("img",{className:N.a.thumbnail,alt:"User submitted",src:e.path})}))]})}))]})},A=function(e){var t,n=Object(s.b)(),i=n.user,o=(n.isAuthenticated,n.isLoading),r=n.getAccessTokenSilently,u=e.id,h=Object(a.useState)({}),g=Object(d.a)(h,2),m=g[0],p=g[1],x=null!==(t=m.photo)&&void 0!==t?t:[],f=Object(a.useState)(!1),v=Object(d.a)(f,2),y=v[0],C=v[1],k=Object(l.c)(),w=e.setNavPath;Object(a.useEffect)((function(){o||O(r,"photos/gallery/"+u).then((function(e){p(e[0]),w([{name:i.name+" Galleries",link:"/loggedin/"},{name:e[0].gallery_name,link:"/gallery/"+u}])})).catch((function(e){return console.log(e)}))}),[o]);return Object(c.jsxs)("div",{className:b.a.container,children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{onClick:function(){return k("/loggedin/")},children:"Back to gallery list!"}),Object(c.jsx)("h2",{children:m.gallery_name}),Object(c.jsxs)("p",{children:["Authorized Users: ",m.authorized_user_ids]}),Object(c.jsx)("button",{className:y?b.a.invisible:b.a.visible,type:"button",name:"editformgo",onClick:function(){return C(!0)},children:"Edit"}),Object(c.jsxs)("form",{className:y?b.a.floating:b.a.invisible,children:[Object(c.jsx)("input",{type:"text",name:"name",value:m.gallery_name,onChange:function(e){return p(Object(j.a)(Object(j.a)({},m),{},{gallery_name:e.target.value}))}}),Object(c.jsx)("label",{children:" Authorized Users (separate by commas): "}),Object(c.jsx)("input",{type:"text",name:"name",value:m.authorized_user_ids,onChange:function(e){return p(Object(j.a)(Object(j.a)({},m),{},{authorized_user_ids:e.target.value.toString().split(",")}))}}),Object(c.jsx)("button",{className:y?b.a.visible:b.a.invisible,type:"button",name:"save",onClick:function(){var e={gallery_name:m.gallery_name,authorized_user_ids:m.authorized_user_ids,owner_id:m.owner_id};O(r,"gallery/update/"+u,e).catch((function(e){return console.log(e)})),C(!1)},children:"Edit"}),Object(c.jsx)("button",{type:"button",name:"editformcancel",onClick:function(){return C(!1)},children:"Cancel"})]}),Object(c.jsx)("button",{onClick:function(){return k("/photos/new/"+m._id)},children:"Add new photo."})]}),Object(c.jsx)("div",{className:b.a.topalign,children:x&&x.map((function(e){return Object(c.jsx)(_,{photo:e})}))})]})},R=n(35),L=n(45),z=n(24),M=n.n(z),P=n(91),E=n(90),T=n(40),B=n.n(T),U=function(e){var t,n=e.xloc,a=e.yloc,i=e.diam,o=e.active,r=e.hidden,l=void 0!==r&&r,s=e.onClick,u=e.text,d=void 0===u?"":u,j=Math.max(i,10);return"number"!==typeof j&&(j=10),t=s||function(){},Object(c.jsx)("div",{style:{display:l?"none":"block",position:"absolute",border:o?"3px solid red":"3px dashed white",top:a-j/2+"px",left:n-j/2+"px",borderRadius:j+"px",width:j-3+"px",height:j-3+"px",padding:i/8+"px",margin:"0px",color:"white"},onClick:t,onMouseDown:function(e){return e.stopPropagation()},children:d})},F=function(e){var t=e.photo,n=e.setPhoto,i=e.commentloc,o=e.setCommentLoc,r=e.setActiveComment,l=Object(s.b)(),u=l.user,h=l.getAccessTokenSilently,b=Object(a.useState)("Enter text here . . . "),g=Object(d.a)(b,2),m=g[0],p=g[1],x=null!==i&&void 0!==i?i:{},f=x.xloc,_=x.yloc,v=x.xpct,y=x.ypct,C=x.diam,k=x.diampct;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(U,{xloc:f,yloc:_,diam:C,active:!0,hidden:null===i}),Object(c.jsx)("div",{className:i?B.a.addcomment:B.a.hidden,style:i?{position:"absolute",top:_+C/2+10,left:Math.max(f-300,0)}:null,children:Object(c.jsxs)("form",{name:"AddComment",children:[Object(c.jsx)("textarea",{rows:"4",cols:"75",name:"comment",value:m,onChange:function(e){return p(e.target.value)}}),Object(c.jsx)("button",{type:"button",onClick:function(e){var c;c=t.comments?Object(j.a)(Object(j.a)({},t),{},{comments:[].concat(Object(R.a)(t.comments),[{user_id:u.sub,user_name:u.name,x:v,y:y,diam:k,comment:m}])}):Object(j.a)(Object(j.a)({},t),{},{comments:[{user_id:u.sub,user_name:u.name,x:v,y:y,diam:k,comment:m}]}),n(c),console.log("Saving photo",c,"To path: ",t._id),O(h,"photos/update/"+t._id,c).then((function(e){return n(e.photo[0])})).catch((function(e){return console.log(e)})),o(null),p("Enter text here . . . "),r(null)},children:"Submit"}),Object(c.jsx)("button",{type:"button",onClick:function(){p("Enter text here . . . "),o(null)},children:"Cancel"})]})})]})},G=function(e){var t,n=Object(s.b)(),i=n.user,o=n.isLoading,r=n.getAccessTokenSilently,u=e.id,h=Object(a.useState)(0),b=Object(d.a)(h,2),g=b[0],m=b[1],p=Object(a.useState)({}),x=Object(d.a)(p,2),f=x[0],_=x[1],v=Object(a.useState)({}),y=Object(d.a)(v,2),C=(y[0],y[1]),k=Object(a.useState)(!1),w=Object(d.a)(k,2),N=w[0],S=w[1],A=Object(a.useState)(null),z=Object(d.a)(A,2),T=z[0],B=z[1],G=Object(a.useState)(null),D=Object(d.a)(G,2),I=D[0],Y=D[1],J=Object(a.useState)(10),W=Object(d.a)(J,2),q=W[0],X=W[1],V=Object(a.useState)({xloc:0,yloc:0,diam:10,hidden:!0}),Z=Object(d.a)(V,2),H=Z[0],K=Z[1],Q=Object(a.useRef)(null),$=Object(a.useRef)(null),ee=Object(l.c)();Object(a.useEffect)((function(){o||O(r,"photos/"+u).then((function(e){console.log(e.photo[0]),_(Object(j.a)(Object(j.a)({},e.photo[0]),{},{gallery_name:e.gallery_name,gallery_id:e._id})),C({gallery_name:e.gallery_name,gallery_id:e._id});var t,n=Object(L.a)(e.photo[0].ratings);try{for(n.s();!(t=n.n()).done;){var c=t.value;if(console.log("looking at",c.user_id),c.user_id===i.sub){m(c.rating);break}}}catch(a){n.e(a)}finally{n.f()}})).catch((function(e){return console.log(e)})),console.log("Ran use effect")}),[o]);return Object(c.jsxs)("div",{className:M.a.container,children:[Object(c.jsxs)("div",{ref:$,id:"img_container",name:"imagecontainer",onMouseDown:function(e){t=Q.current.getBoundingClientRect();var n={xloc:e.clientX-t.left,yloc:e.clientY-t.top,diam:q,hidden:!1};K(n),X(10),Y(null)},onMouseUp:function(e){if(!H.hidden){t=Q.current.getBoundingClientRect();var n=Math.round((H.xloc-t.left)/t.width*100),c=Math.round((H.yloc-t.top)/t.height*100),a=q/t.width*100;B(Object(j.a)(Object(j.a)({},H),{},{xpct:n,ypct:c,diam:q,diampct:a})),Y(null),K({xloc:0,yloc:0,diam:10,hidden:!0})}},onMouseMove:function(e){if(t=Q.current.getBoundingClientRect(),!H.hidden){e.preventDefault();var n=Math.max(10,2*Math.sqrt(Math.pow(e.clientX-t.left-H.xloc,2)+Math.pow(e.clientY-t.top-H.yloc,2)));X(n)}},children:[Object(c.jsx)(U,{xloc:H.xloc,yloc:H.yloc,diam:q,active:!0,hidden:H.hidden},"selector"),Object(c.jsx)("img",{onLoad:function(){return Y(27)},src:f.path,ref:Q,alt:"User submitted with comments"}),f.comments&&f.comments.map((function(e,n){t=Q.current.getBoundingClientRect();var a=e.x/100*t.width+t.left,i=e.y/100*t.height+t.top;console.log(e.x,e.y,e.diam);var o=e.diam/100*t.width;return Object(c.jsx)(U,{onClick:function(t){t.stopPropagation(),I===e._id?Y(null):Y(e._id)},xloc:a,yloc:i,diam:o,active:I===e._id,hidden:!1,text:n+1},e._id)}))]}),Object(c.jsx)("div",{className:"star",children:Object(c.jsx)(E.a,{component:"fieldset",mb:3,borderColor:"transparent",children:Object(c.jsx)(P.a,{name:"simple-controlled",value:g,onChange:function(e,t){m(t),function(e){var t,n=!1;f.ratings&&f.ratings.length?(t=Object(j.a)(Object(j.a)({},f),{},{ratings:f.ratings.map((function(t){return t.user_id===i.sub?(n=!0,Object(j.a)(Object(j.a)({},t),{},{rating:e,user_name:i.name})):t}))}),n||(t=Object(j.a)(Object(j.a)({},t),{},{ratings:[].concat(Object(R.a)(t.ratings),[{rating:e,user_id:i.sub,user_name:i.name}])}))):t=Object(j.a)(Object(j.a)({},f),{},{ratings:[{rating:e,user_id:i.sub,user_name:i.name}]}),_(t),O(r,"photos/update/"+u,t).catch((function(e){return console.log(e)}))}(t)}})})}),Object(c.jsx)("button",{onClick:function(){N&&O(r,"photos/update/"+u,f).then((function(e){_(Object(j.a)({},e.photo[e.photo.length-1])),C({gallery_name:e.gallery_name,gallery_id:e._id})})).catch((function(e){return console.log(e)})),S(!N)},children:N?"Save":"Edit"}),Object(c.jsx)("form",{className:N?M.a.floating:" "+M.a.invisible,children:Object(c.jsx)("input",{type:"text",name:"path",value:f.path,onChange:function(e){return _(Object(j.a)(Object(j.a)({},f),{},{path:e.target.value}))}})}),Object(c.jsx)(F,{comment:I,setActiveComment:Y,commentloc:T,setCommentLoc:B,photo:f,setPhoto:_,id:u}),Object(c.jsx)("h5",{children:"Ratings"}),f.ratings&&f.ratings.map((function(e){return Object(c.jsxs)("p",{children:[e.user_name," - ",e.rating]})})),Object(c.jsx)("h5",{children:"Comments"}),f.comments&&f.comments.map((function(e,t){return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("p",{onClick:function(){I===e._id?Y(null):Y(e._id)},className:I===e._id?M.a.active:M.a.regular,children:"".concat(t+1,": ").concat(e.user_name," (").concat(e.x,", ").concat(e.y,") - ").concat(e.comment)})})})),Object(c.jsx)("button",{onClick:function(){return ee("/gallery/"+f.gallery_id)},children:"Go back to gallery!"})]})},D=function(e){var t=e.user,n=t.name,a=t.picture,i=t.sub,o=e.navpath,r=Object(l.c)();return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{style:{display:"inline-block",width:"700px",textAlign:"left"},children:[console.log("Navpath: ",o),o.length&&o.map((function(e,t){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("a",{href:e.link,onClick:function(t){t.preventDefault(),r(e.link)},children:e.name}),t<o.length-1?Object(c.jsx)("b",{children:" -> "}):""]})}))]}),Object(c.jsxs)("div",{style:{display:"inline-block",width:"270px",textAlign:"right"},children:[Object(c.jsx)("h3",{children:n}),Object(c.jsx)("img",{style:{maxWidth:"40px",maxHeight:"40px",border:"1px solid darkgrey",borderRadius:"20px"},alt:"User photo",src:a}),Object(c.jsx)("button",{onClick:function(){return r("/user/"+i)},children:"Edit User"})]})]})},I=function(e){var t=Object(s.b)(),n=t.user,i=t.isAuthenticated,o=t.isLoading,r=Object(a.useState)([]),j=Object(d.a)(r,2),h=j[0],b=j[1];return o?Object(c.jsx)("div",{children:"Loading . . . "}):i?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(D,{user:n,navpath:h}),Object(c.jsxs)(l.a,{children:[Object(c.jsx)(S,{path:"/loggedin",setNavPath:b}),Object(c.jsx)(v,{path:"/gallery/new"}),Object(c.jsx)(A,{path:"/gallery/:id",setNavPath:b}),Object(c.jsx)(k,{path:"/photos/new/:togallery"}),Object(c.jsx)(G,{path:"/photos/:id",setNavPath:b})]})]}):Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Not Logged In"}),Object(c.jsx)("p",{children:"You must be logged in to perform this action."}),Object(c.jsx)(u,{})]})},Y=n(18),J=n(41),W=n(46),q=void 0,X=function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:8000/api/photos/owner/123");case 3:return t=e.sent,e.abrupt("return",t.json());case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),V=function(e){var t=Object(a.useState)([]),n=Object(d.a)(t,2),i=n[0],o=n[1];return Object(a.useEffect)((function(){X().then((function(e){return o(e)}))})),Object(c.jsxs)("div",{className:"Main",style:{width:"auto"},children:[Object(c.jsx)("h1",{className:"UserName",children:"No login"}),Object(c.jsx)(J.a,{onClick:l.b.bind(q,"/gallery/new"),children:"Add gallery!"}),Object(c.jsx)(W.a,{children:i&&i.map((function(e){return Object(c.jsxs)(Y.a,{children:[Object(c.jsx)(Y.a.Img,{variant:"top",src:e.photo[0]&&e.photo[0].path}),Object(c.jsx)(Y.a.Title,{children:e.gallery_name}),Object(c.jsxs)(Y.a.Body,{children:[Object(c.jsx)(Y.a.Title,{children:e.title}),Object(c.jsxs)("p",{children:["Photos: ",e.photo.length]})]}),Object(c.jsx)(Y.a.Footer,{children:Object(c.jsx)(J.a,{onClick:l.b.bind(q,"/gallery/"+e._id),children:"View Gallery"})})]},e._id)}))})]})};var Z=function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(u,{path:"/"}),Object(c.jsx)(V,{path:"/nologin/"}),Object(c.jsx)(I,{path:"/*"})]})})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,94)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),i(e),o(e)}))};r.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(s.a,{domain:"dev-08umzn2o.us.auth0.com",clientId:"76OKk6yoIt4f4W4ChvVmYytfgRcZqI1I",redirectUri:"http://localhost:3000/loggedin/",audience:"https://localhost:8000/api/",scope:"read:any",children:Object(c.jsx)(Z,{})})}),document.getElementById("root")),H()},9:function(e,t,n){e.exports={container:"gallery_container__1zL05",invisible:"gallery_invisible__2g5X5",visible:"gallery_visible__gRXYO",floating:"gallery_floating__1MyD8",topalign:"gallery_topalign__2_RN5"}}},[[75,1,2]]]);
//# sourceMappingURL=main.86908113.chunk.js.map