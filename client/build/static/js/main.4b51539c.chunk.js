(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{26:function(e,t,n){e.exports={login:"login_login__2-Fm9",title:"login_title__1gPww",buttons:"login_buttons__1zKoK",register:"login_register__1jlVz",logout:"login_logout__1DbZx"}},27:function(e,t,n){e.exports={container:"Details_container__29AQe",invisible:"Details_invisible__3uXzr",floating:"Details_floating__OPBMb",active:"Details_active__2QhPP",regular:"Details_regular__3S4CD"}},43:function(e,t,n){e.exports={container:"gallery_container__1_R-N",invisible:"gallery_invisible__23liP",floating:"gallery_floating__4l7hT"}},44:function(e,t,n){e.exports={hidden:"addcomment_hidden__31WXD",addcomment:"addcomment_addcomment__hTkal"}},58:function(e,t,n){},59:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),i=n.n(a),o=n(33),r=n.n(o),l=(n(58),n(59),n(9)),s=n(10),d=n(26),u=n.n(d),j=function(){var e=Object(s.b)(),t=e.loginWithRedirect,n=e.logout;return Object(c.jsx)("div",{className:u.a.login,children:Object(c.jsxs)("div",{className:u.a.buttons,children:[Object(c.jsx)("h1",{className:u.a.title,children:"Welcome to Photoly or SnapCap!"}),Object(c.jsx)("button",{type:"button",onClick:function(){return t()},className:u.a.register,children:"Login or Register"}),Object(c.jsx)("button",{type:"button",onClick:function(){return n()},className:u.a.logout,children:"Logout"})]})})},h=(n(71),n(7)),b=n(6),m=n(11),O=n(22),g=n(25),p=n.n(g),x=n(35),f=function(){var e=Object(x.a)(p.a.mark((function e(t,n,c){var a,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({});case 3:return i=e.sent,a=c?{method:"POST",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify(c)}:{method:"GET",headers:{Authorization:"Bearer ".concat(i)}},e.next=7,fetch("http://localhost:8000/api/"+n,a);case 7:return o=e.sent,e.abrupt("return",o.json());case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,c){return e.apply(this,arguments)}}(),_=void 0,y=function(e){var t=Object(s.b)(),n=t.isLoading,i=t.user,o=t.getAccessTokenSilently,r=Object(a.useState)([]),d=Object(h.a)(r,2),u=d[0],j=d[1];return Object(a.useEffect)((function(){n||f(o,"photos/owner/123").then((function(e){return j(e)})).catch((function(e){return console.log(e)}))}),[n]),Object(c.jsxs)("div",{className:"Main",style:{width:"auto"},children:[Object(c.jsx)("h1",{className:"UserName",children:i.name}),Object(c.jsx)(m.a,{onClick:l.b.bind(_,"/gallery/new"),children:"Add gallery!"}),Object(c.jsx)(O.a,{children:u&&u.map((function(e){return Object(c.jsxs)(b.a,{children:[Object(c.jsx)(b.a.Img,{variant:"top",src:e.photo[0]&&e.photo[0].path}),Object(c.jsx)(b.a.Title,{children:e.gallery_name}),Object(c.jsxs)(b.a.Body,{children:[Object(c.jsx)(b.a.Title,{children:e.title}),Object(c.jsxs)("p",{children:["Photos: ",e.photo.length]})]}),Object(c.jsx)(b.a.Footer,{children:Object(c.jsx)(m.a,{onClick:l.b.bind(_,"/gallery/"+e._id),children:"View Gallery"})})]},e._id)}))})]})},v=n(5),w=n(19),C=n(43),k=n.n(C),N=void 0,S=function(e){var t,n=Object(s.b)(),i=n.isLoading,o=n.user,r=n.getAccessTokenSilently,d=Object(a.useState)({}),u=Object(h.a)(d,2),j=u[0],g=u[1],p=e.id,x=e.isnew,_=Object(a.useState)(!1),y=Object(h.a)(_,2),C=y[0],S=y[1];Object(a.useEffect)((function(){i||(x?(g({gallery_name:"New gallery . . . ",authorized_user_ids:"List authorized users . . . "}),S(!0)):f(r,"photos/gallery/"+p).then((function(e){return g(e[0])})).catch((function(e){return console.log(e)})))}),[i]);return Object(c.jsxs)("div",{className:"Main",style:{width:"auto"},children:[Object(c.jsxs)("h1",{className:"UserName",children:["User: ",o.name]}),Object(c.jsxs)("h3",{children:["Gallery: ",j.gallery_name]}),Object(c.jsx)(m.a,{onClick:l.b.bind(N,"/Detail/new/"+j._id),children:"Add new photo!"}),Object(c.jsx)(m.a,{onClick:l.b.bind(N,"/loggedin"),children:"Back to Galleries"}),Object(c.jsx)(m.a,{onClick:function(){if(C){var e=x?"new":"update/"+p,t={gallery_name:j.gallery_name,authorized_user_ids:j.authorized_user_ids,owner_id:x?"123":j.owner_id};f(r,"gallery/"+e,t).then((function(e){return g(e)})).catch((function(e){return console.log(e)}))}S(!C)},children:C?"Save":"Edit"}),Object(c.jsxs)("form",{className:C?k.a.floating:k.a.invisible,children:[Object(c.jsx)("input",{type:"text",name:"name",value:null!==(t=j.gallery_name)&&void 0!==t?t:"Loading . . . ",onChange:function(e){return g(Object(v.a)(Object(v.a)({},j),{},{gallery_name:e.target.value}))}}),Object(c.jsx)(m.a,{name:"editformcancel",onClick:function(){return S(!1)},children:"Cancel"})]}),Object(c.jsx)(O.a,{children:j.photo&&j.photo.length&&j.photo.map((function(e){return Object(c.jsxs)(b.a,{children:[Object(c.jsx)(b.a.Img,{variant:"top",src:e.path}),Object(c.jsxs)(b.a.Body,{children:[Object(c.jsx)(b.a.Title,{children:"Title Goes Here"}),Object(c.jsx)(w.a,{variant:"flush",children:e.comments.length&&e.comments.map((function(e){return Object(c.jsxs)(w.a.Item,{children:["-",e.comment]},e._id)}))})]}),Object(c.jsx)(b.a.Footer,{children:Object(c.jsx)(m.a,{onClick:l.b.bind(N,"/Detail/"+e._id),children:"View Photo"})})]},e._id)}))})]})},M=n(39),T=n(47),D=n(90),P=n(89),A=n(27),L=n.n(A),B=n(44),F=n.n(B),R=function(e){var t,n=e.xloc,a=e.yloc,i=e.diam,o=e.active,r=e.hidden,l=void 0!==r&&r,s=e.onClick,d=e.text,u=void 0===d?"":d,j=Math.max(i,10);return"number"!==typeof j&&(j=10),t=s||function(){},Object(c.jsx)("div",{style:{display:l?"none":"block",position:"absolute",border:o?"3px solid red":"3px dashed white",top:a-j/2+"px",left:n-j/2+"px",borderRadius:j+"px",width:j-3+"px",height:j-3+"px",padding:i/8+"px",margin:"0px",color:"white"},onClick:t,onMouseDown:function(e){return e.stopPropagation()},children:u})},E=function(e){var t=e.photo,n=e.setPhoto,i=e.commentloc,o=e.setCommentLoc,r=e.setActiveComment,l=Object(s.b)(),d=l.user,u=l.getAccessTokenSilently,j=Object(a.useState)("Enter text here . . . "),b=Object(h.a)(j,2),m=b[0],O=b[1],g=null!==i&&void 0!==i?i:{},p=g.xloc,x=g.yloc,_=g.xpct,y=g.ypct,w=g.diam,C=g.diampct;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(R,{xloc:p,yloc:x,diam:w,active:!0,hidden:null===i}),Object(c.jsx)("div",{className:i?F.a.addcomment:F.a.hidden,style:i?{position:"absolute",top:x+w/2+10,left:Math.max(p-300,0)}:null,children:Object(c.jsxs)("form",{name:"AddComment",children:[Object(c.jsx)("textarea",{rows:"4",cols:"75",name:"comment",value:m,onChange:function(e){return O(e.target.value)}}),Object(c.jsx)("button",{type:"button",onClick:function(e){var c;c=t.comments?Object(v.a)(Object(v.a)({},t),{},{comments:[].concat(Object(M.a)(t.comments),[{user_id:d.sub,user_name:d.name,x:_,y:y,diam:C,comment:m}])}):Object(v.a)(Object(v.a)({},t),{},{comments:[{user_id:d.sub,user_name:d.name,x:_,y:y,diam:C,comment:m}]}),n(c),console.log("Saving photo",c,"To path: ",t._id),f(u,"photos/update/"+t._id,c).then((function(e){return n(e.photo[0])})).catch((function(e){return console.log(e)})),o(null),O("Enter text here . . . "),r(null)},children:"Submit"}),Object(c.jsx)("button",{type:"button",onClick:function(){O("Enter text here . . . "),o(null)},children:"Cancel"})]})})]})};function z(e){var t,n=Object(s.b)(),o=n.user,r=n.isLoading,d=n.getAccessTokenSilently,u=e.id,j=e.togallery,b=e.isnew,O=Object(a.useState)({}),g=Object(h.a)(O,2),p=g[0],x=g[1],_=Object(a.useState)(!1),y=Object(h.a)(_,2),C=y[0],k=y[1],N=Object(a.useState)(null),S=Object(h.a)(N,2),A=S[0],B=S[1],F=Object(a.useState)(null),z=Object(h.a)(F,2),I=z[0],X=z[1],G=Object(a.useState)(10),U=Object(h.a)(G,2),Y=U[0],V=U[1],H=Object(a.useState)({xloc:0,yloc:0,diam:10,hidden:!0}),J=Object(h.a)(H,2),W=J[0],K=J[1],Q=i.a.useState(2),q=Object(h.a)(Q,2),Z=q[0],$=q[1],ee=Object(a.useState)({}),te=Object(h.a)(ee,2),ne=te[0],ce=te[1],ae=Object(a.useRef)(null),ie=Object(a.useRef)(null),oe=Object(l.c)();Object(a.useEffect)((function(){r||(b?(x({ratings:[]}),k(!0),ce({gallery_id:j})):f(d,"photos/"+u).then((function(e){x(Object(v.a)(Object(v.a)({},e.photo[0]),{},{gallery_name:e.gallery_name,gallery_id:e._id})),ce({gallery_name:e.gallery_name,gallery_id:e._id});var t,n=Object(T.a)(e.photo[0].ratings);try{for(n.s();!(t=n.n()).done;){var c=t.value;if(console.log("looking at",c.user_id),c.user_id===o.sub){$(c.rating);break}}}catch(a){n.e(a)}finally{n.f()}})).catch((function(e){return console.log(e)})))}),[r]);return Object(c.jsxs)("div",{className:L.a.container,children:[Object(c.jsx)("h1",{class:"UserName",children:"Picture Name Goes Here"}),Object(c.jsxs)("div",{ref:ie,id:"img_container",name:"imagecontainer",onMouseUp:function(e){if(!W.hidden){t=ae.current.getBoundingClientRect();var n=Math.min(100,Math.round((W.xloc-t.left-window.pageXOffset)/t.width*100)),c=Math.min(100,Math.round((W.yloc-t.top-window.pageYOffset)/t.height*100)),a=Math.min(Y/t.width*100);B(Object(v.a)(Object(v.a)({},W),{},{xpct:n,ypct:c,diam:Y,diampct:a})),X(null),K({xloc:0,yloc:0,diam:10,hidden:!0})}},onMouseMove:function(e){if(!W.hidden){e.preventDefault();var t=Math.max(10,2*Math.sqrt(Math.pow(e.clientX+window.pageXOffset-W.xloc,2)+Math.pow(e.clientY+window.pageYOffset-W.yloc,2)));V(t)}},children:[Object(c.jsx)(R,{xloc:W.xloc,yloc:W.yloc,diam:Y,active:!0,hidden:W.hidden},"selector"),Object(c.jsx)("img",{onLoad:function(){return X(27)},src:p.path,ref:ae,alt:"User submitted with comments",onMouseDown:function(e){var t={xloc:e.clientX+window.pageXOffset,yloc:e.clientY+window.pageYOffset,diam:Y,hidden:!1};K(t),V(10),X(null)}}),p.comments&&p.comments.map((function(e,n){t=ae.current.getBoundingClientRect();var a=e.x/100*t.width+t.left+window.pageXOffset,i=e.y/100*t.height+t.top+window.pageYOffset,o=e.diam/100*t.width;return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(R,{onClick:function(t){t.stopPropagation(),I===e._id?X(null):X(e._id)},xloc:a,yloc:i,diam:o,active:I===e._id,hidden:!1,text:n+1},e._id)})}))]}),Object(c.jsx)("div",{className:"star",children:Object(c.jsxs)(P.a,{component:"fieldset",mb:3,borderColor:"transparent",children:["My Rating:",Object(c.jsx)(D.a,{name:"simple-controlled",value:Z,onChange:function(e,t){C||($(t),function(e){console.log(p);var t,n=!1;p.ratings&&p.ratings.length?(t=Object(v.a)(Object(v.a)({},p),{},{ratings:p.ratings.map((function(t){return t.user_id===o.sub?(n=!0,Object(v.a)(Object(v.a)({},t),{},{rating:e,user_name:o.name})):t}))}),n||(t=Object(v.a)(Object(v.a)({},t),{},{ratings:[].concat(Object(M.a)(t.ratings),[{rating:e,user_id:o.sub,user_name:o.name}])}))):t=Object(v.a)(Object(v.a)({},p),{},{ratings:[{rating:e,user_id:o.sub,user_name:o.name}]}),x(t),f(d,"photos/update/"+u,t).catch((function(e){return console.log(e)}))}(t))}})]})}),Object(c.jsx)(m.a,{onClick:function(){C&&(b?f(d,"photos/add/"+j,p).then((function(e){x(Object(v.a)({},e.photo[e.photo.length-1])),ce({gallery_name:e.gallery_name,gallery_id:e._id})})).catch((function(e){return console.log(e)})):f(d,"photos/update/"+u,p).catch((function(e){return console.log(e)}))),k(!C)},children:C?"Save":"Edit"}),Object(c.jsxs)("form",{className:C?L.a.floating:" "+L.a.invisible,children:[Object(c.jsx)("input",{type:"text",name:"path",value:p.path,onChange:function(e){return x(Object(v.a)(Object(v.a)({},p),{},{path:e.target.value}))}}),Object(c.jsx)(m.a,{onClick:function(){return k(!1)},children:"Cancel"})]}),Object(c.jsx)(E,{comment:I,setActiveComment:X,commentloc:A,setCommentLoc:B,photo:p,setPhoto:x}),Object(c.jsx)("h5",{children:"Ratings"}),Object(c.jsx)(w.a,{children:Object(c.jsx)(w.a.Item,{children:p.ratings&&p.ratings.map((function(e){return Object(c.jsxs)("p",{children:[e.user_name," - ",e.rating]})}))})}),Object(c.jsx)("h5",{children:"Comments"}),Object(c.jsx)(w.a,{children:Object(c.jsx)(w.a.Item,{children:p.comments&&p.comments.map((function(e,t){return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("p",{className:I===e._id?L.a.active:L.a.regular,children:"".concat(t+1,": ").concat(e.user_name," (").concat(e.x,", ").concat(e.y,") - ").concat(e.comment)})})}))})}),Object(c.jsx)("button",{onClick:function(){return oe("/gallery/"+ne.gallery_id)},children:"Go back to gallery!"})]})}var I=function(e){var t=Object(s.b)(),n=t.isAuthenticated;return t.isLoading?Object(c.jsx)("div",{children:"Loading . . . "}):n?Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(y,{path:"/loggedin"}),Object(c.jsx)(S,{path:"/gallery/new",isnew:!0}),Object(c.jsx)(S,{path:"/gallery/:id"}),Object(c.jsx)(z,{path:"/Detail/new/:togallery",isnew:!0}),Object(c.jsx)(z,{path:"/Detail/:id"})]})}):Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Not Logged In"}),Object(c.jsx)("p",{children:"You must be logged in to perform this action."}),Object(c.jsx)(j,{})]})},X=void 0,G=function(){var e=Object(x.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:8000/api/photos/owner/123");case 3:return t=e.sent,e.abrupt("return",t.json());case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),U=function(e){var t=Object(a.useState)([]),n=Object(h.a)(t,2),i=n[0],o=n[1];return Object(a.useEffect)((function(){G().then((function(e){return o(e)}))})),Object(c.jsxs)("div",{className:"Main",style:{width:"auto"},children:[Object(c.jsx)("h1",{className:"UserName",children:"No login"}),Object(c.jsx)(m.a,{onClick:l.b.bind(X,"/gallery/new"),children:"Add gallery!"}),Object(c.jsx)(O.a,{children:i&&i.map((function(e){return Object(c.jsxs)(b.a,{children:[Object(c.jsx)(b.a.Img,{variant:"top",src:e.photo[0]&&e.photo[0].path}),Object(c.jsx)(b.a.Title,{children:e.gallery_name}),Object(c.jsxs)(b.a.Body,{children:[Object(c.jsx)(b.a.Title,{children:e.title}),Object(c.jsxs)("p",{children:["Photos: ",e.photo.length]})]}),Object(c.jsx)(b.a.Footer,{children:Object(c.jsx)(m.a,{onClick:l.b.bind(X,"/gallery/"+e._id),children:"View Gallery"})})]},e._id)}))})]})};var Y=function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(j,{path:"/"}),Object(c.jsx)(U,{path:"/nologin/"}),Object(c.jsx)(I,{path:"/*"})]})})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,93)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),i(e),o(e)}))};r.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(s.a,{domain:"dev-ikbjrful.us.auth0.com",clientId:"3rDcBgHYzrw6x2tdXuVTNwR07RwwkVC8",redirectUri:"http://localhost:3000/loggedin/",audience:"http://localhost:8000/api/",scope:"read:any",children:Object(c.jsx)(Y,{})})}),document.getElementById("root")),V()}},[[75,1,2]]]);
//# sourceMappingURL=main.4b51539c.chunk.js.map